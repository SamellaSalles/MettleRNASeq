% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca_analysis.R
\name{pca_analysis}
\alias{pca_analysis}
\title{Perform PCA Analysis and Generate Plots}
\usage{
pca_analysis(
  count_matrix,
  design_matrix = NULL,
  color_by = NULL,
  shape_by = NULL,
  center = TRUE,
  scale = FALSE,
  plot_cos2 = FALSE,
  plot_corrplot = NULL,
  plot_2d = TRUE,
  plot_3d = FALSE,
  gradient_cols = c("#00AFBB", "#E7B800", "#FC4E07")
)
}
\arguments{
\item{count_matrix}{A data frame or matrix where rows are samples and columns are genes. Row names should be sample names.}

\item{design_matrix}{A data frame specifying the conditions, batches, or other metadata for each sample. Default is \code{NULL}.}

\item{color_by}{Character or vector. If a character, it should be the column name in \code{design_matrix} to use for coloring samples. If a vector, it should be a factor or numeric vector for coloring. Default is \code{NULL}.}

\item{shape_by}{Character or vector. If a character, it should be the column name in \code{design_matrix} to use for shaping samples. If a vector, it should be a factor or numeric vector for shaping. Default is \code{NULL}.}

\item{center}{Logical. Whether to center the data before performing PCA. Default is \code{TRUE}.}

\item{scale}{Logical. Whether to scale the data before performing PCA. Default is \code{FALSE}.}

\item{plot_cos2}{Logical. If \code{TRUE}, a plot of the cos2 values (quality of representation) is generated. Default is \code{FALSE}.}

\item{plot_corrplot}{Character. If not \code{NULL}, a correlation plot of the PCA results is generated. Options are \code{"cos2"}, \code{"contrib"}, or \code{"coord"}. Default is \code{NULL}.}

\item{plot_2d}{Logical. If \code{TRUE}, a 2D PCA plot is generated. Default is \code{TRUE}.}

\item{plot_3d}{Logical. If \code{TRUE}, a 3D PCA plot is generated. Default is \code{FALSE}.}

\item{gradient_cols}{A vector of colors for the gradient in the cos2 plot. Default is \code{c("#00AFBB", "#E7B800", "#FC4E07")}.}
}
\value{
A list containing:
\itemize{
\item \code{pca_result}: The result of the \code{prcomp} function.
\item \code{eigenvalues}: Eigenvalues of the principal components.
\item \code{variance}: Variance explained by each principal component.
\item \code{cumulative_variance}: Cumulative variance explained by the principal components.
\item \code{cos2}: Cos2 values (quality of representation) for each sample.
\item \code{ind}: The result of \code{get_pca_ind}, containing cos2, coord, and contrib.
}
}
\description{
This function performs Principal Component Analysis (PCA) on a count matrix and provides options for visualizing the results.
It computes eigenvalues, variance, cumulative variance, and cos2 values to assess how well samples are represented by each principal component.
The function also generates 2D and 3D PCA plots, with optional coloring and shaping based on specified columns of a design matrix or direct vectors.
}
\examples{
# Example 1: PCA analysis with a design matrix
# Example count matrix (samples as rows, genes as columns)
count_matrix <- data.frame(
  Gene1 = c(10, 20, 30),
  Gene2 = c(15, 25, 35),
  Gene3 = c(12, 22, 32)
)

# Example design matrix (conditions for each sample)
design_matrix <- data.frame(
  Condition = c("A", "A", "B")
)

# Perform PCA analysis and generate plots
pca_results <- pca_analysis(count_matrix, design_matrix = design_matrix, color_by = "Condition", shape_by = NULL, center = TRUE, scale = TRUE, plot_3d = TRUE)

# Access PCA results
pca_results$pca_result
pca_results$eigenvalues
pca_results$cos2

# Example 2: PCA analysis with color and shape vectors (no design matrix)
color <- c("F", "F", "S")
shape <- c("FA", "FB", "SB")

# Perform PCA analysis with custom color and shape vectors, generating 2D and 3D plots
pca_results <- pca_analysis(count_matrix, plot_2d = TRUE, plot_cos2 = FALSE, design_matrix = NULL, color_by = color, shape_by = shape, plot_3d = TRUE)
}
