% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/normalize_count_matrix.R
\name{normalize_count_matrix}
\alias{normalize_count_matrix}
\title{Clean and Normalize a Count Matrix Using TMM, DESeq2, or Scaling}
\usage{
normalize_count_matrix(
  count_matrix,
  remove_low_variance = TRUE,
  min_count = 10,
  group_size = 4,
  method = "TMM"
)
}
\arguments{
\item{count_matrix}{A data frame or matrix where rows are samples and columns are genes. Row names should be sample names.}

\item{remove_low_variance}{Logical. If \code{TRUE}, genes with zero variance across samples are removed. Default is \code{TRUE}.}

\item{min_count}{Numeric. The minimum count threshold for a gene to be retained. Genes with counts below this threshold in at least \code{group_size} samples are removed. Default is \code{10}.}

\item{group_size}{Numeric. The minimum number of samples where a gene must meet the \code{min_count} threshold to be retained. Default is \code{4}.}

\item{method}{Character. The normalization method to use. Options are \code{"TMM"} (edgeR), \code{"DESeq2"}, or \code{"scale"}. Default is \code{"TMM"}.}
}
\value{
A normalized count matrix (data frame) with samples as rows and genes as columns. Row names are preserved.
}
\description{
This function normalizes a count matrix using one of three methods: TMM (edgeR), DESeq2, or scaling.
It also provides options to filter out low-variance genes, remove low-count genes, and remove samples with zero library size.
}
\details{
The function performs the following steps:
\enumerate{
\item Converts the input matrix to numeric and preserves row names.
\item Removes genes with zero variance if \code{remove_low_variance = TRUE}.
\item Filters out genes with counts below \code{min_count} in fewer than \code{group_size} samples.
\item Removes samples with zero library size.
\item Normalizes the count matrix using the specified method:
\itemize{
\item \strong{TMM}: Trimmed Mean of M-values normalization (edgeR).
\item \strong{DESeq2}: Size factor normalization (DESeq2).
\item \strong{scale}: Column-wise scaling (mean-centered and scaled to unit variance).
}
}
}
\examples{
# Example count matrix (samples as rows, genes as columns)
count_matrix <- data.frame(
  Gene1 = c(10, 20, 30, 40),
  Gene2 = c(15, 25, 35, 45),
  Gene3 = c(12, 22, 32, 42)
)

# Normalize using TMM
norm_counts <- normalize_count_matrix(count_matrix, method = "TMM")

# Normalize using DESeq2
norm_counts <- normalize_count_matrix(count_matrix, method = "DESeq2")

# Normalize using scaling
norm_counts <- normalize_count_matrix(count_matrix, method = "scale")

}
